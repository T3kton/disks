#!/bin/sh
#SOURCE: https://media.luffy.cx/files/lldpd/lldpd-0.9.9.tar.gz
#FILE: lldpd-0.9.9.tar.gz
#HASH: 681ef98485d553332979472544220b84e37934a0

set -e
set -x

build()
{
  tar --strip-components=1 -xzf $1
  ./configure --with-json --with-privsep-user=root --with-privsep-group=root --with-privsep-chroot=/ --prefix=/
  make
}

install()
{
  cp -f $3/src/client/.libs/lldpcli $1/sbin
  cp -f $3/src/daemon/lldpd $1/sbin
  cp -f $3/src/lib/.libs/liblldpctl.so.4.8.0 $1/lib

  for LIB in /lib/x86_64-linux-gnu/libbsd.so.0.8.7 \
  /lib/x86_64-linux-gnu/libreadline.so.7.0 \
  /usr/lib/x86_64-linux-gnu/libxml2.so.2.9.4 \
  /usr/lib/x86_64-linux-gnu/libicuuc.so.60.2 \
  /usr/lib/x86_64-linux-gnu/libicudata.so.60.2 \
  /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.25 \
  /lib/x86_64-linux-gnu/libgcc_s.so.1
  do
    cp -L $LIB $1/lib
  done
}
