#!/bin/sh
#SOURCE: https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.19.128.tar.xz
#HASH: a96add8134be86baa5c91f9bcca505bd4d647f22

set -e
#set -x

build()
{
  tar --strip-components=1 -xJf $1
  TARGET_PATH=/
  if [ "x$1" = "xx86_64" ]
  then
    cp ../../configs/linux.x86_64 .config
    make $2
    make modules $2
    make INSTALL_HDR_PATH=$TARGET_PATH headers_install
  elif [ "x$1" = "xarm" ]
  then
    cp ../../configs/linux.arm .config
    make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- $2
    make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- modules $2
    make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- INSTALL_HDR_PATH=$TARGET_PATH headers_install
  elif [ "x$1" = "xarm64" ]
  then
    cp ../../configs/linux.arm64 .config
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- $2
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- modules $2
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- INSTALL_HDR_PATH=$TARGET_PATH headers_install
  fi
}

install()
{
  : # allready installed ;-)
}


# update glibc if the version of the kernel changes
