#!/bin/sh
#SOURCE: https://mirrors.edge.kernel.org/pub/linux/utils/raid/mdadm/mdadm-4.0.tar.xz
#FILE: mdadm-4.0.tar.xz
#HASH: 0886a47e8109f86160e45896ca6dc445fdeee710

set -e
#set -x

# sed is to fix a error introduced in gcc 7.1
# would be nice to do the CROSS_COMPILE=arm-linux-gnueabihf- instad of CC=arm-linux-gnueabihf-gcc
build()
{
  tar --strip-components=1 -xJf $1
  sed 's@-Werror@@' -i Makefile
  if [ "x$3" = "xx86_64" ]
  then
    make $4
  elif [ "x$3" = "xarm" ]
  then
    make CC=arm-linux-gnueabihf-gcc $4
  elif [ "x$3" = "xarm64" ]
  then
    make CC=aarch64-linux-gnu-gcc $4
  fi
}

install()
{
  cp -f $3/mdadm $1/sbin
}

binaries()
{
  ls $1/sbin/mdadm*
}
