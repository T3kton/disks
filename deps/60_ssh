#!/bin/sh
#SOURCE: https://cloudflare.cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-9.8p1.tar.gz
#HASH: a0bb501b11349f5c5c33a269351be091dc2c2727

set -e
#set -x

build()
{
  tar --strip-components=1 -xzf $1
  if [ "x$2" = "xx86_64" ]
  then
    ./configure --prefix= --without-pam --sysconfdir=/etc/ssh --with-privsep-path=/var/empty
  elif [ "x$2" = "xarm" ]
  then
    ./configure --prefix= --without-pam --sysconfdir=/etc/ssh --with-privsep-path=/var/empty --host arm-linux-gnueabihf --build x86_64-pc-linux-gnu
  elif [ "x$2" = "xarm64" ]
  then
    ./configure --prefix= --without-pam --sysconfdir=/etc/ssh --with-privsep-path=/var/empty --host aarch64-linux-gnu --build x86_64-pc-linux-gnu
  fi
  make $3
}

install()
{
  cp -f $3/sshd $1/sbin
  cp -f $3/ssh $1/bin
  cp -f $3/sftp-server $1/sbin
  cp -f $3/scp $1/bin
  cp -f $3/ssh-keygen $1/bin
}

binaries()
{
  ls $1/sbin/ssh*
  ls $1/sbin/sftp-server
}
